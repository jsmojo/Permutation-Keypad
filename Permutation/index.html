<!DOCTYPE html>
<html lang="en" data-ng-app="textInputExample">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Permutations with Keypad</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.16/angular.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      
    </style>
</head>

<body>
    <div class="container" ng-controller="ExampleController">
        <div class="row">
            <div class="col col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1 col-xs-12">
                <form role="form">
                    <h1>Permutation using the phone keypad</h1>
                    <p>
                        <input class="digitInput form-control" type="text" data-ng-model="nineDigits" maxlength="10" placeholder="Enter numbers/digits here or use the keypad below" />
                    </p>
                    <div class="keypad" data-ng-model="keypad">
                        <ul>
                            <li ng-repeat="(key,value) in phone" ng-click="getKeyDown($event)"><span class="num">{{key}}</span><span class="letter-value">{{value}}</span></li>
                        </ul>
                    </div></br>
                    <p><strong>Phone number</strong> : <span class="phoneFormat"></span>{{nineDigits | tel}}</p>

                    <p><strong>Permutation count</strong> : <span class="arryCounter"></span></p>
                    <p><strong>Permutation Array</strong> : <span class="arrayPermutation"></span></p>
                    <div my-output class="form-group">
                        <textarea type="text" class="combResults form-control" rows="10" cols="20" placeholder="Results"></textarea>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script>
    angular.module('textInputExample', [])
        .controller('ExampleController', ['$scope', function($scope) {
            $scope.nineDigits;
            $scope.keypad;
        }])
        .directive('myOutput', function() {
            return {
                restrict: 'A',
                link: function(scope, elm) {
                        var numValues = {
                            '1': "1",
                            '2': "ABC",
                            '3': "DEF",
                            '4': "GHI",
                            '5': "JKL",
                            '6': "MNO",
                            '7': "PQRS",
                            '8': "TUV",
                            '9': "WXYZ",
                            '*': "#",
                            '0': "0",
                            '#': "#"
                        };
                        scope.phone = numValues;
                        scope.getKeyDown = function(event, key, value) {

                            $(event.target).parent().addClass('active').delay(500).queue( function(){
                               $(this).removeClass('active', 500)
                            })
                            if(scope.nineDigits != undefined) {
                                scope.nineDigits += this.key;
                            }
                            else {
                                scope.nineDigits = this.key;
                            }

                        };
                        function permute(input) {

                                var permute = [];
                                var numbers = input;
                                //assign numbers to alphabet values if avaiable.
                                for (var i = 0; i < numbers.length; i++) {
                                    if (numbers[i] in numValues) {
                                        permute[i] = numValues[numbers[i]].split('');
                                    } else {
                                        permute[i] = numbers[i].split('');
                                    }
                                }
                                function casesPossible(arr) {
                                    //console.log(arr.length);
                                    if (arr.length == 0) {
                                        return [];
                                    } else if (arr.length == 1) {
                                        return arr[0];
                                    } else {
                                        var results = [];
                                        var allCasesOfRest = casesPossible(arr.slice(1));
                                        for (var i = 0; i < allCasesOfRest.length; i++) {
                                            for (var j = 0; j < arr[0].length; j++) {
                                                results.push(arr[0][j] + allCasesOfRest[i]);
                                            }
                                        }
                                        return results;
                                    }
                                }
                                results = casesPossible(permute);
                                $('.arryCounter').html(results.length);
                                $('.arrayPermutation').html(JSON.stringify(permute));
                                $('.combResults').html(JSON.stringify(results));
                            } // End permute function
                        scope.$watch(function(value) {
                            //console.log("keypress : " + value.nineDigits);
                            if (scope.nineDigits != undefined) {
                                var angInput = scope.nineDigits.split("");
                                permute(angInput);
                            }
                        })
                    } //End
            };
        })
        .filter('tel', function() {
            return function(tel) {
                //console.log(tel);
                if (!tel) {
                    return '';
                }
                var value = tel.toString().trim().replace(/^\+/, '');
                if (value.match(/[^0-9]/)) {
                    return tel;
                }
                var country, city, number;
                switch (value.length) {
                    case 1:
                    case 2:
                    case 3:
                        city = value;
                        break;
                    default:
                        city = value.slice(0, 3);
                        number = value.slice(3);
                }
                if (number) {
                    if (number.length > 3) {
                        number = number.slice(0, 3) + '-' + number.slice(3, 7);
                    } else {
                        number = number;
                    }
                    return ("(" + city + ") " + number).trim();
                } else {
                    return "(" + city;
                }
            };
        });
    </script>
</body>

</html>